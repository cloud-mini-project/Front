<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>SEVEN BANK</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <%- include('include/head-link.html') %>

        <!-- =======================================================
  * Template Name: Lumia
  * Template URL: https://bootstrapmade.com/lumia-bootstrap-business-template/
  * Updated: Mar 17 2024 with Bootstrap v5.3.3
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->

        <!-- <style>
    .outlined-table {
        outline: 2px solid gray; /* Outline properties */
        outline-offset: 5px;    /* Outline offset */
    }
    </style> -->
        <style>
            #imgs,
            #files {
                display: flex;
                overflow-x: auto;
                margin-top: 10px;
            }

            #imgs img {
                width: 100px;
                height: 100px;
                object-fit: cover;
                margin: 5px;
                margin: 5px;
                border: 1px solid #ccc;
                border-radius: 5px;
            }

            #files span {
                display: inline-block;
                padding: 5px;
                margin: 5px;
                border: 1px solid #ccc;
                border-radius: 5px;
                white-space: nowrap;
            }
        </style>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script>

            $(window).on('load', function () {
                // 공지사항 불러오기
                $.ajax({
                    url: '/api/notice/<%= id %>',
                    type: 'GET',
                    success: function (body) {
                        console.log(body);
                        const data = body.data;
                        /*
                            {
                                "status": "success",
                                "message": "공지사항 상세 조회 성공",
                                "data": {
                                    "user_id": 0,
                                    "notice_id": 22,
                                    "name": "test",
                                    "email": "test",
                                    "role": "test",
                                    "title": "zzz",
                                    "content": "zzz",
                                    "created": "2024-07-06T22:58:56.000Z",
                                    "file": "public/notice/e5177fa1-b5d6-42a0-81f8-d4439e6249c0",
                                    "img": "public/notice/e5177fa1-b5d6-42a0-81f8-d4439e6249c0"
                                }
                            }
                        */


                        // 제목
                        $('#notice-title').text(data.title);
                        // 내용
                        $('#notice-content').text(data.content);
                        // 작성자
                        $('#notice-author').text('작성자: ' + data.name);
                        // 작성일
                        $('#notice-created').text('작성일: ' + data.created);

                        if (data.img) {
                            let imageFiles = data.imgFiles;
                            imageFiles.forEach((file) => {
                                $('#imgs').append(`<img src="/${file}" alt="${file}" class="img-thumbnail" style="cursor: pointer;" data-bs-toggle="modal" data-bs-target="#imageModal" onclick="$('#image-modal').attr('src', '/${file}');">`);
                            });
                        }

                        // 첨부 파일 (한 줄로 클릭 시 다운로드, 표시는 경로 제외하고 파일명만)
                        if (data.file) {
                            let files = data.files;
                            files.forEach((file) => {
                                let fileName = file.split('/').pop();
                                $('#files').append(`<span><a href="/${file}" download>${fileName}</a></span>`);
                            });
                        }

                    }
                });
            });
        </script>
</head>

<body>
    <!-- ======= Header ======= -->
    <header id="header" class="fixed-top d-flex align-items-center">
        <%- include('include/nav.html') %>
    </header><!-- End Header -->


    <main id="main" style="margin-top: 100px;">


        <div class="container">
            <!-- Announcements Section -->
            <div class="col">
                <h2>공지사항 세부 정보</h2>

                <div class="card">
                    <div class="card-body">
                        <h5 id="notice-title" class="card-title">제목</h5>
                        <p id="notice-content" class="card-text">내용</p>
                        <p id="notice-author" class="card-text">작성자: 작성자</p>
                        <p id="notice-created" class="card-text">작성일: 작성일</p>
                    </div>
                </div>
            </div>

            <div class="col">
                <h2 class="mt-5">첨부 파일</h2>
                <div class="card">
                    <div id="files" class="card-body">
                    </div>
                </div>
            </div>

            <div class="col">
                <h2 class="mt-5">이미지</h2>
                <div class="card">
                    <div id="imgs" class="card-body">
                    </div>
                </div>
            </div>

            <!-- 작성 버튼 (배치 오른쪽) -->
            <button type="button" class="btn btn-outline-primary mt-5" style="float: right;" data-bs-toggle="modal"
                data-bs-target="#noticeModal">작성</button>
        </div>
        </div>


    </main><!-- End #main -->

    <!-- ======= Footer ======= -->
    <footer id="footer">

        <div class="footer-top">
            <div class="container">
                <div class="row">

                    <div class="col-lg-3 col-md-6 footer-contact">
                        <h3>Seven bank</h3>
                        <p>
                            대한민국 KOR<br>
                            서울 Seoul<br>
                            종로구 종로3길 17<br>
                            D1동 16층, 17층<br>
                            03155<br>
                            <br><br>
                            <strong>Phone:</strong> +82 000 0000 0000 <br>
                            <strong>Email:</strong> info@example.com<br>
                        </p>
                    </div>

                    <div class="col-lg-5 col-md-6 footer-teaminfo">
                        <h3>WEB Final Project_Team#7</h3>
                        <p></p>
                        <ul>
                            <li>
                                <h4>[조장] 손빈 : 프로젝트 파이팅 담당</h4>
                            </li>
                            <p></p>
                            <li>
                                <h4>[팀원] 윤현석 : 묵묵히 성실 작업 담당</h4>
                            </li>
                            <p></p>
                            <li>
                                <h4>[팀원] 채홍무 : 파이팅 호응 담당</h4>
                            </li>
                            <p></p>
                            <li>
                                <h4>[팀원] 최건우 : 경고 2장</h4>
                            </li>
                            <p></p>
                        </ul>
                    </div>

                    <div class="col-lg-4 col-md-6 footer-newsletter">
                        <h4>Join Our Newsletter</h4>
                        <p>Tamen quem nulla quae legam multos aute sint culpa legam noster magna</p>
                        <form action="" method="post">
                            <input type="email" name="email"><input type="submit" value="Subscribe">
                        </form>
                    </div>

                </div>
            </div>
        </div>

        <div class="container d-md-flex py-4">

            <div class="me-md-auto text-center text-md-start">
                <div class="copyright">
                    &copy; Copyright <strong><span>Lumia</span></strong>. All Rights Reserved
                </div>
                <div class="credits">
                    <!-- All the links in the footer should remain intact. -->
                    <!-- You can delete the links only if you purchased the pro version. -->
                    <!-- Licensing information: https://bootstrapmade.com/license/ -->
                    <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/lumia-bootstrap-business-template/ -->
                    Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
                </div>
            </div>
            <div class="social-links text-center text-md-right pt-3 pt-md-0">
                <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
                <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
                <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
                <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
                <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
            </div>
        </div>
    </footer><!-- End Footer -->

    <!--부트스트랩 공지사항 작성 폼 (제목, 내용, 이미지 파일(복수), 첨부 파일(복수) - 이미지와 첨부파일 모두 하나씩 추가 가능해야 함)-->
    <div class="modal fade" id="noticeModal" tabindex="-1" aria-labelledby="noticeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="noticeModalLabel">공지사항 작성</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-start">
                    <form method="post" action="/api/notice" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label for="noticeTitle" class="col-form-label">제목:</label>
                            <input type="text" class="form-control" id="noticeTitle" name="title">
                        </div>
                        <div class="mb-3">
                            <label for="noticeContent" class="col-form-label">내용:</label>
                            <!-- <textarea class="form-control" id="noticeContent" name="content" rows="5"></textarea> -->
                            <textarea class="form-control" id="noticeContent" name="content" rows="5"></textarea>
                        </div>
                        <div class="mb-3">
                            <input type="file" id="image-input" accept="image/*" name="imgs" multiple>
                            <button type="button" id="image-add-button" class="btn btn-primary">이미지 추가</button>
                            <div id="image-preview"></div>
                        </div>
                        <div class="mb-3">
                            <input type="file" id="file-input" name="files" multiple>
                            <button type="button" id="file-add-button" class="btn btn-primary">파일 추가</button>
                            <div id="file-preview"></div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                            <input type="submit" class="btn btn-primary" value="작성">
                        </div>
                    </form>
                </div>

            </div>
        </div>
    </div>

    <!-- 이미지 클릭시 확대해서 보여줄 모달-->
    <div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="imageModalLabel">이미지</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <img id="image-modal" class="img-thumbnail" src="" alt="이미지">
                </div>
            </div>
        </div>
    </div>

    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
            class="bi bi-arrow-up-short"></i></a>

    <%- include('include/body-js.html') %>

</body>

</html>